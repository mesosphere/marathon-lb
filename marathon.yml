id: /{{app_name}}
cpus: 0.01
mem: 128
instances: {{count}}
args: [ 
    "sse",
    "--group={{marathon_group_name}}",
    "--marathon={{marathon_url}}",
    "--auth-credentials={{marathon_creds}}"
    ]
container:
  docker:
    image: registry.nutmeg.co.uk:8443/marathon-lb:{{version}}
    forcePullImage: true
    network: HOST
    parameters:
      -
        key: "label"
        value: "APP_NAME={{app_name}}"
      -
        key: "label"
        value: "APP_BUILD={{version}}"
env:
  NC_ID: {{nutcracker_id}}
  NC_KEY: {{nutcracker_key}}
  NC_SERVER: {{nutcracker_server}}
  NM_ENV: {{env}}
constraints:
  -
    - hostname
    - UNIQUE
  -
    - {{cluster_key}}
    - CLUSTER
    - {{cluster_value}}
upgradeStrategy:
  minimumHealthCapacity: 0.75
  maximumOverCapacity: 0