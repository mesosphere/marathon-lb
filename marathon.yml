id: /{{APP_NAME}}
cpus: 0.01
mem: 128
constraints:
  -
    - hostname
    - LIKE
    - 172.22.3.242
args: [ 
    "sse",
    "--group=internal",
    "--marathon=http://172.22.1.20:8080",
    "--auth-credentials=marathon:NutmegMarathon"
    ]
container:
  docker:
    image: mesosphere/marathon-lb:{{VERSION}}
    network: BRIDGE
    portMappings:
      - 
        containerPort: 80
        hostPort: 0
        servicePort: 0
      -
        containerPort: 443
        hostPort: 0
        servicePort: 0
      -
        containerPort: 9090
        hostPort: 0
        servicePort: 0
      -
        containerPort: 9091
        hostPort: 0
        servicePort: 0
    parameters:
      -
        key: "label"
        value: "APP_NAME={{APP_NAME}}"
      -
        key: "label"
        value: "APP_BUILD={{VERSION}}"
healthChecks:
  -
    protocol: HTTP
    path: /_haproxy_health_check
    intervalSeconds: 5
    timeoutSeconds: 2
    maxConsecutiveFailures: 2
    portIndex: 2
